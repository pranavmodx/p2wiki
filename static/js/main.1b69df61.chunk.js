(this.webpackJsonpp2wiki=this.webpackJsonpp2wiki||[]).push([[0],{102:function(e,t,n){},103:function(e,t,n){},129:function(e,t){},140:function(e,t){},142:function(e,t){},148:function(e,t){},149:function(e,t){},150:function(e,t){},156:function(e,t){},171:function(e,t){},172:function(e,t){},174:function(e,t){},176:function(e,t){},178:function(e,t){},193:function(e,t){},199:function(e,t){},200:function(e,t){},203:function(e,t){},209:function(e,t){},243:function(e,t){},244:function(e,t,n){},245:function(e,t,n){"use strict";n.r(t);var a=n(2),o=n.n(a),i=n(94),c=n.n(i),r=(n(102),n(103),n(32)),l=n(33),s=n(35),u=n(34),f=n(95),h=n(13),m=n(96),d=n.n(m),p=n(54),g=n(15),y=n(158),b=["ws://localhost:5000","wss://tracker.openwebtorrent.com","wss://tracker.sloppyta.co:443/announce","wss://tracker.novage.com.ua:443/announce"];"localhost"===window.location.hostname&&(b=["ws://localhost:5000"]);var v=function(e,t){};if("true"===localStorage.getItem("beAProxy")){var k=new y,w=new File(["p2wiki"],"p2wiki");k.seed(w,{announce:b},(function(e){console.log(e.infoHash),e.on("peer",(function(e){e.on("data",(function(t){console.log("got a message from a client: "+t),"p"===t&&e.send("p");try{var n=JSON.parse(t);d.a.get("//en.wikipedia.org/w/api.php?action=parse&format=json&page=".concat(n.q,"&prop=text&formatversion=2&origin=*")).then((function(t){console.log(t),e.send(JSON.stringify(t))})).catch((function(e){console.log(e),alert("Not Found- Try with a more Specific Title")}))}catch(a){}}))}))}))}else{var x=function(e){delete E[e],delete O[O.indexOf(e)],v("peersCount",Object.keys(E).length)},E={},O=[],S=new p({infoHash:"62f753362edbfcc2f59593a050bf271d20dec9d2",peerId:g(20),announce:b});S.on("peer",(function(e,t){e.on("connect",(function(){E[e.id]=e,O.push(e.id),v("peersCount",Object.keys(E).length),e.on("data",(function(t){console.log("got a message from a proxy: "+t),O.push(O.splice(O.indexOf(e.id),1)[0])}));setTimeout((function t(){e.connected?(e.send("p"),setTimeout(t,1e3)):x(e.id)}),1e3)})),e.on("close",(function(){x(e.id)}))})),S.on("error",(function(e){console.log(e)}))}function j(e){return new Promise((function(t,n){var a=0!==Object.keys(E).length&&E[O[O.length-1]];a?(a.on("data",(function(e){try{var n=JSON.parse(e);t(n)}catch(a){}})),a.send(e),a.on("error",(function(e){v("search","Peer connection failed"),n(Error(e))}))):(v("search","No peers available"),n("nopeer"))}))}var P=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(r.a)(this,n),(a=t.call(this,e)).getFromWiki=function(){if(""!==a.state.query){var e=Object(h.a)(a);(t=a.state.query,j(JSON.stringify({q:t}))).then((function(t){e.setState({title:t.data.parse.title,result:t.data.parse.text})})).catch((function(t){"nopeer"===t&&(console.log("nopeer, retrying in 3 seconds"),setTimeout(e.getFromWiki,3e3))}))}var t},a.handleSubmit=function(e){e.preventDefault(),console.log(a.state.query),a.getFromWiki()},a.handleChange=a.handleChange.bind(Object(h.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(h.a)(a)),a.state={title:"",query:"",result:"",beAProxy:!1},"true"===localStorage.getItem("beAProxy")&&(a.state.beAProxy=!0);var o=Object(h.a)(a),i=document.location.pathname.split("/");return i.length>2&&"wiki"===i[i.length-2]&&setTimeout((function(){o.urloli(i[i.length-1]),o.getFromWiki()}),1e3),v=function(e,t){console.log(e,t)},a}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t="checkbox"===e.target.type?e.target.checked:e.target.value;this.setState(Object(f.a)({},e.target.name,t)),"beAProxy"===e.target.name&&(localStorage.setItem("beAProxy",t),window.location.reload())}},{key:"urloli",value:function(e){this.setState({query:e})}},{key:"render",value:function(){var e;return o.a.createElement("div",null,o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("label",{className:"checkbox"},o.a.createElement("input",{type:"checkbox",onChange:this.handleChange,name:"beAProxy",checked:this.state.beAProxy}),o.a.createElement("span",{style:{marginLeft:"5px"}},"Be a Proxy Peer")),o.a.createElement("div",{className:"field"},o.a.createElement("div",{className:"control"},o.a.createElement("input",{className:"input is-rounded",id:"query",type:"Text",placeholder:"\ud83d\udd0d Search for an article",onChange:this.handleChange,name:"query",value:this.state.query})))),o.a.createElement("div",{className:"container mx-auto"},o.a.createElement("h1",{className:"title text-4xl"},this.state.title),o.a.createElement("div",{dangerouslySetInnerHTML:(e=this.state.result,{__html:e})})))}}]),n}(o.a.Component),N=(n(244),function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("h1",{style:{color:"royalblue",fontSize:"50px"}},"P2Wiki"),o.a.createElement(P,null)),o.a.createElement("footer",{className:"footer"},o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("p",{style:{color:"hotpink"}},"P2Wiki made by Subin Siby, Pranav Shridhar and Athul Cyriac Ajay"))))}}]),n}(a.Component));var A=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(N,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},97:function(e,t,n){e.exports=n(245)}},[[97,1,2]]]);
//# sourceMappingURL=main.1b69df61.chunk.js.map